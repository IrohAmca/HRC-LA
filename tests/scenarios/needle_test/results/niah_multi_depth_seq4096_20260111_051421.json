{
  "experiment": "niah_multi_depth",
  "timestamp": "20260111_051421",
  "config": {
    "seq_len": 4096,
    "vocab_size": 64,
    "d_model": 64,
    "num_heads": 4,
    "num_layers": 1,
    "m_features": 4,
    "batch_size": 32,
    "learning_rate": 0.0007,
    "num_epochs": 10,
    "num_samples": 5000,
    "needle_depth": 0.5,
    "num_needles": 20,
    "test_multiple_depths": true,
    "num_depth_levels": 20
  },
  "results": {
    "best_val_accuracy": 0.99848828125,
    "total_training_time_seconds": 153.4936237335205,
    "history": [
      {
        "epoch": 1,
        "train_loss": 2.885935846407702,
        "train_acc": 0.696408154296875,
        "val_loss": 0.7317614667117596,
        "val_acc": 0.98886376953125,
        "epoch_time": 15.314861297607422,
        "memory_mb": 797.54248046875
      },
      {
        "epoch": 2,
        "train_loss": 0.7861429783189373,
        "train_acc": 0.992110009765625,
        "val_loss": 0.23004652094095945,
        "val_acc": 0.9947705078125,
        "epoch_time": 14.914645195007324,
        "memory_mb": 797.54248046875
      },
      {
        "epoch": 3,
        "train_loss": 0.49101988335323943,
        "train_acc": 0.995541357421875,
        "val_loss": 0.13424668461084366,
        "val_acc": 0.9964736328125,
        "epoch_time": 15.051998615264893,
        "memory_mb": 797.54248046875
      },
      {
        "epoch": 4,
        "train_loss": 0.3943068333871805,
        "train_acc": 0.99679853515625,
        "val_loss": 0.09763692552223802,
        "val_acc": 0.99730322265625,
        "epoch_time": 16.353628635406494,
        "memory_mb": 797.54248046875
      },
      {
        "epoch": 5,
        "train_loss": 0.34718802438420093,
        "train_acc": 0.997356298828125,
        "val_loss": 0.08035973878577352,
        "val_acc": 0.9977353515625,
        "epoch_time": 15.137406826019287,
        "memory_mb": 797.54248046875
      },
      {
        "epoch": 6,
        "train_loss": 0.3208797236157071,
        "train_acc": 0.9976587890625,
        "val_loss": 0.07020409684628248,
        "val_acc": 0.99806396484375,
        "epoch_time": 15.709252834320068,
        "memory_mb": 797.54248046875
      },
      {
        "epoch": 7,
        "train_loss": 0.304190305957369,
        "train_acc": 0.997931494140625,
        "val_loss": 0.06503854272887111,
        "val_acc": 0.9982119140625,
        "epoch_time": 15.397135972976685,
        "memory_mb": 797.54248046875
      },
      {
        "epoch": 8,
        "train_loss": 0.2953420328866145,
        "train_acc": 0.998074951171875,
        "val_loss": 0.06237006955780089,
        "val_acc": 0.99835546875,
        "epoch_time": 15.281174898147583,
        "memory_mb": 797.54248046875
      },
      {
        "epoch": 9,
        "train_loss": 0.29057183121420016,
        "train_acc": 0.9981447265625,
        "val_loss": 0.06059926189482212,
        "val_acc": 0.9984521484375,
        "epoch_time": 15.195162773132324,
        "memory_mb": 797.54248046875
      },
      {
        "epoch": 10,
        "train_loss": 0.286592735606394,
        "train_acc": 0.998225,
        "val_loss": 0.05913094710558653,
        "val_acc": 0.99848828125,
        "epoch_time": 15.133334875106812,
        "memory_mb": 797.54248046875
      }
    ],
    "depth_analysis": {
      "0.1": {
        "accuracy": 0.998583984375,
        "num_samples": 25
      },
      "0.14210526315789473": {
        "accuracy": 0.9988671875,
        "num_samples": 25
      },
      "0.1842105263157895": {
        "accuracy": 0.998720703125,
        "num_samples": 25
      },
      "0.22631578947368425": {
        "accuracy": 0.998505859375,
        "num_samples": 25
      },
      "0.26842105263157895": {
        "accuracy": 0.9983984375,
        "num_samples": 25
      },
      "0.31052631578947365": {
        "accuracy": 0.998427734375,
        "num_samples": 25
      },
      "0.3526315789473685": {
        "accuracy": 0.99845703125,
        "num_samples": 25
      },
      "0.39473684210526316": {
        "accuracy": 0.998642578125,
        "num_samples": 25
      },
      "0.4368421052631579": {
        "accuracy": 0.998330078125,
        "num_samples": 25
      },
      "0.4789473684210527": {
        "accuracy": 0.998525390625,
        "num_samples": 25
      },
      "0.5210526315789473": {
        "accuracy": 0.998486328125,
        "num_samples": 25
      },
      "0.5631578947368422": {
        "accuracy": 0.998017578125,
        "num_samples": 25
      },
      "0.605263157894737": {
        "accuracy": 0.9983203125,
        "num_samples": 25
      },
      "0.6473684210526316": {
        "accuracy": 0.99857421875,
        "num_samples": 25
      },
      "0.6894736842105263": {
        "accuracy": 0.998359375,
        "num_samples": 25
      },
      "0.731578947368421": {
        "accuracy": 0.99833984375,
        "num_samples": 25
      },
      "0.7736842105263158": {
        "accuracy": 0.9985546875,
        "num_samples": 25
      },
      "0.8157894736842106": {
        "accuracy": 0.998369140625,
        "num_samples": 25
      },
      "0.8578947368421053": {
        "accuracy": 0.9986328125,
        "num_samples": 25
      },
      "0.9": {
        "accuracy": 0.99865234375,
        "num_samples": 25
      }
    }
  }
}